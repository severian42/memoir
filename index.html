<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Living Memoir</title>
    <link rel="stylesheet" href="/index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Removed Google GenAI import map - no longer using AI features -->
  </head>
  <body>
    <div class="app-container">
        <header class="app-header">
            <h1 class="app-title"><i class="fas fa-book-open"></i> The Living Memoir</h1>
            <div class="header-actions">
              <span id="save-status" class="save-status" title="Your memoir is automatically saved every 30 seconds. Green checkmark means all changes are saved safely in your browser.">
                <i class="fas fa-check-circle"></i>
              </span>
              <button class="action-button" id="exportButton" title="üìñ Compile & Export Your Memoir - Click to preview your complete memoir and save it as a PDF file to your computer. You can also export/import your data for backup.">
                <i class="fas fa-file-export"></i>
                <span class="button-label">Export</span>
              </button>
              <button class="action-button danger-button" id="clearAllButton" title="üóëÔ∏è Clear All Data - Permanently delete all your memoir content and start fresh. This action cannot be undone.">
                <i class="fas fa-trash-alt"></i>
                <span class="button-label">Clear All</span>
              </button>
              <button class="action-button" id="themeToggleButton" title="üåô Switch Theme - Toggle between dark mode (easier on eyes) and light mode. Your preference is saved automatically.">
                <i class="fas fa-sun"></i>
                <span class="button-label">Theme</span>
              </button>
            </div>
        </header>

        <main id="dashboard-content" class="dashboard-content">
          <!-- Core info and dropdown chapters will be dynamically inserted here -->
        </main>
    </div>

    <div id="consent-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 class="modal-title">Sensitive Topic</h3>
            <p id="consent-prompt-text" class="modal-text"></p>
            <div class="modal-actions">
                <button id="consent-no" class="modal-button secondary">No, skip for now</button>
                <button id="consent-yes" class="modal-button primary">Yes, I'm comfortable</button>
            </div>
        </div>
    </div>

    <div id="compile-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content compile-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Compile & Export Memoir</h3>
                <button id="compile-modal-close" class="action-button close-button" title="Close">&times;</button>
            </div>
            <div class="compile-modal-body">
                <div class="export-instructions">
                    <p><strong>üìñ Your Memoir Preview:</strong> Review your complete memoir below. You can edit the text directly if needed.</p>
                    <p><strong>üíæ To Save as PDF:</strong> Click "Export as PDF" below. Your browser will generate and download a beautifully formatted PDF file.</p>
                    <p><strong>üîí Privacy:</strong> Everything happens in your browser - no data is sent to any servers.</p>
                </div>
                <div class="memoir-title-section">
                    <label for="memoir-title-input" class="memoir-title-label">
                        <i class="fas fa-edit"></i> Memoir Title
                    </label>
                    <input type="text" id="memoir-title-input" class="memoir-title-input" placeholder="Enter your memoir title..." maxlength="100">
                    <div class="title-actions">
                        <button id="suggest-title-btn" class="secondary-button suggest-title-btn">
                            <i class="fas fa-wand-magic-sparkles"></i> Suggest Titles
                        </button>
                        <button id="update-preview-btn" class="secondary-button">
                            <i class="fas fa-refresh"></i> Update Preview
                        </button>
                    </div>
                    <div id="title-suggestions-container" class="title-suggestions-container">
                        <!-- Title suggestions will be rendered here -->
                    </div>
                </div>
                <div id="memoir-preview-content" class="memoir-preview-content" spellcheck="false"></div>
            </div>
            <div class="modal-actions">
                <button id="export-data-btn" class="modal-button secondary" title="üíæ Download a backup file (.json) of all your memoir data to save or share">
                    <i class="fas fa-download"></i> Backup Data
                </button>
                <button id="import-data-btn" class="modal-button secondary" title="üìÅ Upload a previously saved backup file to restore your memoir data">
                    <i class="fas fa-upload"></i> Restore Data
                </button>
                <input type="file" id="import-data-input" accept=".json" style="display: none;">
                <button id="download-memoir-btn" class="modal-button primary" title="üìÑ Generate and download your memoir as a beautifully formatted PDF document">
                    <i class="fas fa-file-pdf"></i> Save as PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Journal Entry Modal -->
    <div id="journal-modal" class="modal-overlay" style="display: none;">
      <div class="modal-content journal-modal-content">
        <div class="modal-header">
            <h3 id="journal-modal-title" class="modal-title">New Journal Entry</h3>
            <button id="journal-modal-close" class="action-button close-button" title="Close">&times;</button>
        </div>
        <form id="journal-form">
          <input type="hidden" id="journal-entry-id">
          <div class="form-field">
            <label for="journal-title">Title</label>
            <input type="text" id="journal-title" class="text-input" required placeholder="Title of your entry">
          </div>
          <div class="form-field">
            <label for="journal-date">Date</label>
            <input type="date" id="journal-date" class="text-input" required>
          </div>
          <div class="form-field">
            <label for="journal-content">Your Story</label>
            <textarea id="journal-content" class="text-input" required placeholder="Write your thoughts, anecdotes, or stories here..."></textarea>
          </div>
          <div class="modal-actions">
              <button type="button" id="journal-delete-btn" class="modal-button danger" style="display: none;">Delete Entry</button>
              <button type="submit" class="modal-button primary">Save Entry</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Clear All Confirmation Modal -->
    <div id="clear-all-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content clear-all-modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‚ö†Ô∏è Clear All Data</h3>
                <button id="clear-all-modal-close" class="action-button close-button" title="Close">&times;</button>
            </div>
            <div class="clear-all-modal-body">
                <div class="warning-message">
                    <div class="warning-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="warning-content">
                        <h4>This will permanently delete ALL your memoir data:</h4>
                        <ul>
                            <li>All answered questions and responses</li>
                            <li>All journal entries</li>
                            <li>Your story's foundation information</li>
                            <li>Custom memoir title</li>
                            <li>All photos and attachments</li>
                        </ul>
                        <p><strong>This action cannot be undone.</strong></p>
                        <p>Consider exporting your memoir as a backup before proceeding.</p>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button id="clear-all-cancel" class="modal-button secondary">Cancel</button>
                <button id="clear-all-confirm" class="modal-button danger">Yes, Delete Everything</button>
            </div>
        </div>
    </div>

    <script type="module" src="/index.tsx"></script>
  </body>
</html>